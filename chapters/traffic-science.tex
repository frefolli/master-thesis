\chapter{Traffic Science}

\section{Introduction}

\paragraph{Terminology}

In the rest of the document I will refer to \textit{transit} or \textit{flow} to indicate a group of traveling vehicles.
The word \textit{traffic} will be used only indicate the phenomenon of high density flows where there is the perception of being slowed down.
The word \textit{jam} will indicate strictly a deadlock traffic event.

\paragraph{Vehicles}

This is a umbrella term for referring to any kind of entity which travels along a network.
Vehicles \textbf{can} have an \textit{origin} and a \textit{destination}: for example, private motor vehicles are usually driven in order to go from a \textit{point-of-interest} A to a point point-of-interest B.
An interesting exception are those public transit vehicles serving on a \textit{circle line} like the M3 City Circle Line of Copenhagen, and in general vehicles offering public transit logically have more than one destination while carrying out a trip.
Vehicles attempt to follow a \textit{desired path}, which is influenced by various factors: network knowledge, habits, transit regulations and so on.
This path can diverge from the \textit{actual path} they end up following for various reasons: accidents, infrastructure works, events and maybe illegal parking.
A notable exception are fixed route vehicles (such as public transit) and in particular track-constrained vehicles (such as trams and trains).
In both cases, the whole journey is not required to be completed: a vehicle can override its route because of change of heart (the case of private vehicles), rescheduling (the case of public transit) or else.
Depending on the goal of a simulation, the flow can be restricted to a small set of vehicle types, but in the real world, the vehicle flow can be heterogeneous: cars, trolleybuses, trams, emergency vehicles, trucks, bicycles, motorbikes and so on. Each vehicle has different physical properties and different permissions.
Vehicles permission rules can be defined by diving the flow with respect to origin/destination, vehicle type (cars \textit{mustn't} ride in bike lanes), local regulations (in some cities, taxis \textit{may} use public transit lanes), vehicle properties (\textit{only} motor vehicles able to reach at least 60 km/h can drive on the motorway) or even driver properties (\textit{limited traffic zones} are open only for residents).
This partitioning activity is a form of transit regulation and characterizing vehicles by their properties rather than transparent objects helps in managing their transit, resolving path conflicts and also enhancing the quality of life of residents (a bypass \textit{should} cut a significant amount of transit vehicles in city centers).
For instance, a study of \citeauthor{schreiter2013vehicle} \cite{schreiter2013vehicle} has proven the effectiveness of differentiating vehicles subject to traffic management measures by class (such as cars and trucks).
A further example comes from a study of \citeauthor{wang2012understanding} \cite{wang2012understanding}, which demonstrated that often a few set of driver sources are cause congestion into the whole network, the flaws of traffic analysis models based only on topological betweenness and how identifying troublemaker traffic sources enables transit authorities to plan effective actions and to fluidify traffic.

\paragraph{Infrastructure}

The road network can be represented with a \textbf{directed multi-graph} of intersections and roads. Each road has one or more lanes, a maximum speed and vehicles permissions dictating which kind of vehicles are allowed to flow through it. While more simplistic models use undirected graph with labelled edges to represent lanes and one/two-way traffic, it should be noted that a simple directed graph wouldn't be sufficient as in real-world road networks the may be more different links between an intersection. While some network slices could be represented with a single edge, there are more complex situations as in figure \ref{fig:multigraph-is-better-than-nothing} (a slice of Viale Zara, Milan, Italy) in which two big intersections are linked with two main one-way three-lane roads, two side one-way one-lane roads ("controviali") and two dedicated links for tramway vehicles. These roads are physically separated with median strips and each link may allow for different turns within the intersections. Of course, the implementation model can be optimized for performance, but the logical model should remain a multi-graph because it better represents the features of the road network.

\putimage{figures/multigraph-is-better-than-nothing.png}{A complex intersection pair which is connected with more different roads (Viale Zara. Milan. Italy). In \textit{green} the main lanes, in \textit{blue} the side lanes, in \textit{orange} the tramway. Source: Google Maps (2025)}{fig:multigraph-is-better-than-nothing}{0.5}

\paragraph{Traffic}

\textbf{Traffic} can be defined as a flow of vehicles on a network with peaks of density in some locations in which the average speed of those vehicles is significantly lower than the average of the entire network.
Mathematically speaking, \textbf{traffic} emerges when many vehicles need or want to transit through a shared path which hasn't enough capacity for handling this high number of users.
Urban planning authorities have since then taken this hint quite literally, adding lanes year-by-year, but in the end the only result was an increase in the number of road vehicles with unchanged transit density or, even worse, with higher travel times \cite{Speck2018}.
In this context, \textbf{traffic science} comes in help: it seeks to understand the causes of traffic as a social \textit{phenomenon} modeling demand and analyzing flaws and strengths of infrastructure.

In the following sections I'll explain and analyze the impact of some strategies for transit regulation and traffic reduction. I'll introduce the concepts of demand modeling. Finally I'll explain the main assumptions for the present simulation and present the scenarios being used.

\section{Transit Regulation}

All the strategies presented in this section involve the usage of infrastructure artifacts in order to optimize transit. The first group aims to manage excessive flows by organizing them into different streams by origin, destination or mean of transportation and modifying the road infrastructure. The second aims to reduce route conflicts and optimize the usage of intersections. None of those is able to "fix" traffic, there are no silver bullets. This section is intended to introduce the reader to the context of transit regulation.

\subsection{Managing high flows}

\paragraph{Just one more lane}

What happens when among all the route that can be possibly be followed there is one which is faster and more convenient? Different streams are going to merge into a single huge flow which is slower than the other ones. A reasonable but ineffective action is to increase the number of lanes \ref{fig:atlanta-georgia-freeway}, but that adds only capacity to the system. It temporally fluidify traffic until other vehicles arrive into the system because it has become more convenient than their current route, and eventually traffic reemerges.

\putimage{figures/atlanta-georgia-freeway.jpg}{A view of Atlanta Freeway, Georgia. Source: \href{https://www.cnu.org/publicsquare/2017/08/03/why-urban-freeway-expansion-futile}{cnu.org}}{fig:atlanta-georgia-freeway}{0.5}

\paragraph{Bypasses, freeways, motorways}

Freeways and motorways are an example of \textit{specialized roads} which can be used to segregate the flows of vehicles needing to travel long distances from the local/regional transit. Those are generally built far from urban areas and those are what prevented urban planners from extending local roads into ten-lanes wide monsters. A further example of specialized road are bypasses, which are used to cut travel times and reduce the number of vehicles that go through the city center, but can also be used in combination with motorways. For example, in image \ref{fig:bologna-bypass} are reported three alternatives proposed by authorities to build a bypass in the Bologna's motorway node to split the flow on the basis of whether those vehicles are going to Bologna or need to reach other destinations like Firenze and Ancona. Specialized roads are generally effective in reducing travel times and represent the more convenient way for traveling mid/long distances, however they require extensive land usage and are subject to increased demand. As they essentially only add capacity to the system, it's only a matter of time before vehicle density reaches jamming levels.

\putimage{figures/bologna-bypass.jpg}{Highlight of alternatives for the Bologna node bypass. Source: Corriere della Sera}{fig:bologna-bypass}{0.5}

\paragraph{Transit zones}

The urban area can be divided into \textit{zones} in which some vehicles can or cannot enter with various kind of rules.
\textit{Restricted traffic zones} (\textbf{ZTL}) are effectively used in city centers to block the entrance of non-resident vehicles and reduce the number of vehicles in the area. Vehicles violating this blockage are subject to a fine. If this fine is too low or if the coverage is limited, the ZTL has the same effects of a CAS.
\textit{Controlled access zones} (\textbf{CAS}) are similar but only require the payment of a toll in order to enter in the zone. An infamous example is the Area C of the city of Milan, where in order to enter it, the driver needs to buy a ticket (but some vehicles are exempts). Usually, the toll is used as a deterrent for persuading drivers to avoid central areas. Unfortunately, this measure is usually misunderstood as a way of taxing non-residents or citizens.
Finally, in \textit{Low emission zones} (\textbf{LEZ}) the only vehicles which entrance is forbidden are the ones exceeding pollution limits (e.g. by Europe emission standards). This measure is effective only in those societies where electric vehicles (EVs) and low-emission vehicles make up a small percentage of registered vehicles, because otherwise a large number of vehicles would not be affected by this regulation.
In general, the more restrictive an area is and the more area it covers, the more it reduces traffic and wear and tear of the road network \cite{derobertis2016traffic}. Nonetheless, zones can also have the side effect of increasing traffic in peripheral areas or citizen rage if the restricted area is not well served by public transit, if the are no interchange parking lots outside of the area and if it's not reachable by other means, such as buses and trains.

\paragraph{Dedicated lanes}

An effective way of cutting travel times and increasing security of vehicles traveling in a mixed network (this is the case of European cities), is drawing \textit{dedicated lanes} for public transit, bikes and pedestrians. In some cities also taxis are allowed to use public transit lanes and if the number of taxis in service is high, it ends up lowering the performance of dedicated lanes. However, cities are limited in space: dedicated lanes mean cutting the number of lanes for use of private vehicles, which take up most of the spaces in urban areas. Urban planners face opposition when cutting the space allocated to cars, so it is vital that such infrastructures are enforces and designed properly in order to satisfy the transit needs of replaced vehicles.

\paragraph{One-way roads}

Where space isn't enough for two-way roads with dedicated lanes, often a good solution is the implementation of one-way roads, which also lead to safer crossings and more manageable flows. This measure actually increases travel times of vehicles, which could induce some private vehicle passengers/drivers to travel with mass public transit or by bicycle, which ultimately can decrease mean travel time of all the users of the network.

\subsection{Managing conflicts}

\paragraph{Cloverleafs}

Intersections can be built in the form of \textit{cloverleafs} to remove entirely conflicts from crossing flows. While this offer high capacity and speed, it requires excessive land usage and cannot be built in urban context without erasing entire neighborhoods. For reader's amusement, the figure \ref{fig:milwaukee-interchange} shows that an stack intersection in Milwaukee is actually bigger than the whole city center of Piacenza, shown in figure \ref{fig:piacenza-city-center}. \footnote{In urbanist literature such a comparison is usually drawn between a Houston intersection and Siena. Since Piacenza is way bigger than Siena, this example is stronger.}

\putimagecouple
{\putsubimage{figures/PiacenzaCityCenter.png}{The city center of Piacenza, Italy. Source: Google Maps}{fig:piacenza-city-center}{0.45}{1.0}}
{\putsubimage{figures/MilwaukeeInterchange.png}{The I-91/I-41 ("Zoo") Interchange in Milkwaukee, USA. Source: Google Maps}{fig:milwaukee-interchange}{0.45}{1.0}}

\paragraph{Precedence rule}

In urban area, non regulated intersections often follow the precedence rule: a vehicle should wait for the transit of a vehicle coming from its right, for example. The clear advantage is the lack of specialized infrastructure, at the cost of dependency on human reaction times and some times it can lead to deadlocks.

\paragraph{Roundabouts}

In roundabouts, the precedence rule is "inverted": the precedence is given to vehicles which are already in the roundabout. Depending on reaction times, it is observed that it grants a continuous flow and minimizes idle times.

\paragraph{Traffic lights}

With respect to other regulation strategies, \textit{traffic lights} are more \textbf{interesting} since they offer flexibility and regulators can apply different programs over time.

\subparagraph{Fixed cycle}

The most common program is the \textit{fixed cycle program}. Every X seconds its state changes, switching from green to yellow and red, effectively selecting from which lanes vehicles are allowed to occupy the intersection and where they can go. An intuition is that with low cycle time (e.g. 10 seconds), the intersection behaves like a roundabout, which is advantageous when dealing with incoming traffic uniformly distributed among the entrances. With long cycles, the queue is less segmented (as start-and-stop phenomenon is reduced) but depending on the distribution of the incoming flows, it can lead to a waste of time, as vehicles from a trafficked main road may need to wait on red a long cycle with a deserted side road on green.

\subparagraph{Green-wave}

Traffic lights can be \textit{synchronized} in order to obtain a so-called \textit{green-wave}, in which many adjacent traffic lights are set to green in order to grant a continuous or uninterrupted flow. This can be achieved by directly synchronizing the phase of all traffic lights or by implementing a cycle schedule allowing groups of vehicles to flow in a direction while maintaining time separation with respect to preceding vehicles and vehicles from other directions crossing the intersections.

\subparagraph{Transit signal priority}

Precedence to tram and buses can be given by detecting their proximity to the traffic light regulated intersection. This drastically reduces waiting times for public transit vehicles, which eventually could reduce the number of circulating private vehicles and thus lower traffic levels. This can be applied also to other type of public vehicles like emergency vehicles.

\section{Demand models}

This section gives an introduction to demand modeling which will be useful in further chapters to explain how demand has been simulated and how scenarios have been created.
The two subsections answer two diffent aspects of demand modeling: space and time.

\subsection{Where do vehicles go?}

In \textit{Origin-destination matrices} (\textbf{OD Matrix}) every cell contains a number representing the approximate demand of transit vehicles from a zone A to a zone B. Depending of the scale of the simulation, zones can be regions, provinces, cities or urban districts.
For example, the Lombardy region yearly analyze traffic and demand \cite{ODLombardia2014} between its cities in order to plan maintenance and improvements in its regional road network.
It is useful that zones partition the area of interest without intersections, otherwise data could be distorted. This is often the case of urban contexts: for example Agenzia Mobilita' Ambiente e Territorio of Milan (AMAT) in 2010 \cite{ODMilano2010} had modeled the urban transit demand of the city of Milan but the zones used for OD matrix are not clearly distinguished (it can be seen in \ref{fig:odzones-milano-2010}) and therefore the matrix has to be taken with coarse-grain granularity.
Nonetheless, counting vehicles and inferring their origin destination it not an easy activity \cite{bell1983estimation}.

\putimage{figures/ODZones.Show.Milano2010.png}{OD Zones used within the 2010 Milan AMAT model.}{fig:odzones-milano-2010}{1.0}

\subsection{When do vehicles depart?}

Usually, mobility agencies create more than one OD matrix in order to capture how traffic levels change during a day.
Some agencies such as AMAT use three time ranges: 07:00-10:00 (morning peak), 10:00-16:00 (off-peak) and 16:00-20:00 (evening peak). 
While other entities like Regione Lombardia, provide hourly data.
In figures \ref{fig:odmatrix-milano-2010} and \ref{fig:odmatrix-lombardy-2014}, it can be seen through mean traffic levels from OD matrices of Milan and Lombardy region can be seen as they estimate a similar situation.
What happens during working days is that there are two major peaks, one in the morning and one in the afternoon/evening, which correspond to workers going and returning from work.
Recently it has emerged also another phenomenon called \textit{third rush hour}, which is a peak at midday due to trips with private vehicles in order to have lunch.
Traffic peaks depend also on the day of the year. In those days before or after the weekend, an increase in trips is registered due to long-distance commutes and holidays in which people are used to travel between an home city and a work/holiday city. It can increase also in proximity of scheduled events like sport matches, concerts, strikes and political demonstrations.
%% Creare un sketch grafico di come si comporta il traffico, magari da sovrapporre a quelli

\putimage{figures/ODGraph.Mean.Lombardia2014.png}{Traffic levels from OD Matrix of Lombardy in 2014.}{fig:odmatrix-lombardy-2014}{1.0}
\putimage{figures/ODGraph.Mean.Milano2010.png}{Traffic levels from OD Matrix of Milan in 2010.}{fig:odmatrix-milano-2010}{1.0}

\section{Settings and assumptions}

I will use transit flows made up of only private vehicles (in particular, cars) and settings will reflect the case of an urban area with one main road and more intersecting side roads. Another powerful assumption is that main/side actually reflect the demand from those directions: there is no hidden disequilibrium.
The scenario \textit{Breda} (figure \ref{fig:setting-breda}) is inspired by Viale Monza, Milan, and has a two-lane two-way main road and two intersecting one-lane two-way roads.
The scenario \textit{Celoria} (figure \ref{fig:setting-celoria}) is inspired by Via Bassini, Milan, and has a two-lane two-way main road and five intersecting one-lane two-way roads.
Since scenarios are synthetic though inspired by real city slices, also flows will be synthetic. Moreover, the distribution of vehicles over time will follow the two-peak rush hour model presented in the previous section and will provide also abnormal traffic conditions. Since the setting is a slice of a wider urban area, such slice is assumed to be tightly connected to neighbor slices as can be seen in figure \ref{fig:city-slice-of-a-whole}, therefore vehicles are assumed to be able to enter freely in the scenario but to face a "queue" when exiting. Intersections in the network are assumed to be regulated by traffic lights, which as by baseline are synchronized with the green-wave mode of operation presented before.

\putimage{figures/setting-celoria.png}{The setting "Celoria" with five intersections.}{fig:setting-celoria}{1.0}
\putimage{figures/setting-isola.png}{The setting "Isola" with nine intersections.}{fig:setting-isola}{1.0}
\putimage{figures/city-slice-of-a-whole.png}{The setting of simulation scenarios is a slice of a highly connected city.}{fig:city-slice-of-a-whole}{0.45}
